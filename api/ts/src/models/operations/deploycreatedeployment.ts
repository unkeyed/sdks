/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import * as components from "../components/index.js";

/**
 * Prebuilt Docker image configuration
 */
export type V2DeployImageSource = {
  /**
   * Prebuilt Docker image reference
   */
  image: string;
  /**
   * Unkey project ID
   */
  projectId: string;
  /**
   * Optional keyspace ID for authentication context
   */
  keyspaceId?: string | undefined;
  /**
   * Git branch name
   */
  branch: string;
  /**
   * Environment slug (e.g., "production", "staging")
   */
  environmentSlug: string;
  /**
   * Optional git commit information
   */
  gitCommit?: components.V2DeployGitCommit | undefined;
};

/**
 * Build context for building from source.
 *
 * @remarks
 * Provide either `build.context` (build from source) or `image` (prebuilt image), but not both.
 */
export type Build = {
  /**
   * S3 path to uploaded build context tarball
   */
  context: string;
  /**
   * Optional path to Dockerfile within build context (defaults to "Dockerfile")
   */
  dockerfile?: string | undefined;
};

/**
 * Build from source configuration
 */
export type V2DeployBuildSource = {
  /**
   * Build context for building from source.
   *
   * @remarks
   * Provide either `build.context` (build from source) or `image` (prebuilt image), but not both.
   */
  build: Build;
  /**
   * Unkey project ID
   */
  projectId: string;
  /**
   * Optional keyspace ID for authentication context
   */
  keyspaceId?: string | undefined;
  /**
   * Git branch name
   */
  branch: string;
  /**
   * Environment slug (e.g., "production", "staging")
   */
  environmentSlug: string;
  /**
   * Optional git commit information
   */
  gitCommit?: components.V2DeployGitCommit | undefined;
};

/**
 * Deployment source - either build from source or use prebuilt image
 */
export type DeployCreateDeploymentRequest =
  | V2DeployBuildSource
  | V2DeployImageSource;

/** @internal */
export type V2DeployImageSource$Outbound = {
  image: string;
  projectId: string;
  keyspaceId?: string | undefined;
  branch: string;
  environmentSlug: string;
  gitCommit?: components.V2DeployGitCommit$Outbound | undefined;
};

/** @internal */
export const V2DeployImageSource$outboundSchema: z.ZodType<
  V2DeployImageSource$Outbound,
  z.ZodTypeDef,
  V2DeployImageSource
> = z.object({
  image: z.string(),
  projectId: z.string(),
  keyspaceId: z.string().optional(),
  branch: z.string(),
  environmentSlug: z.string(),
  gitCommit: components.V2DeployGitCommit$outboundSchema.optional(),
});

export function v2DeployImageSourceToJSON(
  v2DeployImageSource: V2DeployImageSource,
): string {
  return JSON.stringify(
    V2DeployImageSource$outboundSchema.parse(v2DeployImageSource),
  );
}

/** @internal */
export type Build$Outbound = {
  context: string;
  dockerfile: string;
};

/** @internal */
export const Build$outboundSchema: z.ZodType<
  Build$Outbound,
  z.ZodTypeDef,
  Build
> = z.object({
  context: z.string(),
  dockerfile: z.string().default("Dockerfile"),
});

export function buildToJSON(build: Build): string {
  return JSON.stringify(Build$outboundSchema.parse(build));
}

/** @internal */
export type V2DeployBuildSource$Outbound = {
  build: Build$Outbound;
  projectId: string;
  keyspaceId?: string | undefined;
  branch: string;
  environmentSlug: string;
  gitCommit?: components.V2DeployGitCommit$Outbound | undefined;
};

/** @internal */
export const V2DeployBuildSource$outboundSchema: z.ZodType<
  V2DeployBuildSource$Outbound,
  z.ZodTypeDef,
  V2DeployBuildSource
> = z.object({
  build: z.lazy(() => Build$outboundSchema),
  projectId: z.string(),
  keyspaceId: z.string().optional(),
  branch: z.string(),
  environmentSlug: z.string(),
  gitCommit: components.V2DeployGitCommit$outboundSchema.optional(),
});

export function v2DeployBuildSourceToJSON(
  v2DeployBuildSource: V2DeployBuildSource,
): string {
  return JSON.stringify(
    V2DeployBuildSource$outboundSchema.parse(v2DeployBuildSource),
  );
}

/** @internal */
export type DeployCreateDeploymentRequest$Outbound =
  | V2DeployBuildSource$Outbound
  | V2DeployImageSource$Outbound;

/** @internal */
export const DeployCreateDeploymentRequest$outboundSchema: z.ZodType<
  DeployCreateDeploymentRequest$Outbound,
  z.ZodTypeDef,
  DeployCreateDeploymentRequest
> = z.union([
  z.lazy(() => V2DeployBuildSource$outboundSchema),
  z.lazy(() => V2DeployImageSource$outboundSchema),
]);

export function deployCreateDeploymentRequestToJSON(
  deployCreateDeploymentRequest: DeployCreateDeploymentRequest,
): string {
  return JSON.stringify(
    DeployCreateDeploymentRequest$outboundSchema.parse(
      deployCreateDeploymentRequest,
    ),
  );
}
