// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package operations

import (
	"errors"
	"fmt"
	"github.com/unkeyed/sdks/api/go/v2/internal/utils"
	"github.com/unkeyed/sdks/api/go/v2/models/components"
)

// V2DeployImageSource - Prebuilt Docker image configuration
type V2DeployImageSource struct {
	// Prebuilt Docker image reference
	Image string `json:"image"`
	// Unkey project ID
	ProjectID string `json:"projectId"`
	// Optional keyspace ID for authentication context
	KeyspaceID *string `json:"keyspaceId,omitempty"`
	// Git branch name
	Branch string `json:"branch"`
	// Environment slug (e.g., "production", "staging")
	EnvironmentSlug string `json:"environmentSlug"`
	// Optional git commit information
	GitCommit *components.V2DeployGitCommit `json:"gitCommit,omitempty"`
}

func (v V2DeployImageSource) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(v, "", false)
}

func (v *V2DeployImageSource) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &v, "", false, []string{"image", "projectId", "branch", "environmentSlug"}); err != nil {
		return err
	}
	return nil
}

func (v *V2DeployImageSource) GetImage() string {
	if v == nil {
		return ""
	}
	return v.Image
}

func (v *V2DeployImageSource) GetProjectID() string {
	if v == nil {
		return ""
	}
	return v.ProjectID
}

func (v *V2DeployImageSource) GetKeyspaceID() *string {
	if v == nil {
		return nil
	}
	return v.KeyspaceID
}

func (v *V2DeployImageSource) GetBranch() string {
	if v == nil {
		return ""
	}
	return v.Branch
}

func (v *V2DeployImageSource) GetEnvironmentSlug() string {
	if v == nil {
		return ""
	}
	return v.EnvironmentSlug
}

func (v *V2DeployImageSource) GetGitCommit() *components.V2DeployGitCommit {
	if v == nil {
		return nil
	}
	return v.GitCommit
}

// Build context for building from source.
// Provide either `build.context` (build from source) or `image` (prebuilt image), but not both.
type Build struct {
	// S3 path to uploaded build context tarball
	Context string `json:"context"`
	// Optional path to Dockerfile within build context (defaults to "Dockerfile")
	Dockerfile *string `default:"Dockerfile" json:"dockerfile"`
}

func (b Build) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(b, "", false)
}

func (b *Build) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &b, "", false, []string{"context"}); err != nil {
		return err
	}
	return nil
}

func (b *Build) GetContext() string {
	if b == nil {
		return ""
	}
	return b.Context
}

func (b *Build) GetDockerfile() *string {
	if b == nil {
		return nil
	}
	return b.Dockerfile
}

// V2DeployBuildSource - Build from source configuration
type V2DeployBuildSource struct {
	// Build context for building from source.
	// Provide either `build.context` (build from source) or `image` (prebuilt image), but not both.
	//
	Build Build `json:"build"`
	// Unkey project ID
	ProjectID string `json:"projectId"`
	// Optional keyspace ID for authentication context
	KeyspaceID *string `json:"keyspaceId,omitempty"`
	// Git branch name
	Branch string `json:"branch"`
	// Environment slug (e.g., "production", "staging")
	EnvironmentSlug string `json:"environmentSlug"`
	// Optional git commit information
	GitCommit *components.V2DeployGitCommit `json:"gitCommit,omitempty"`
}

func (v V2DeployBuildSource) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(v, "", false)
}

func (v *V2DeployBuildSource) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &v, "", false, []string{"build", "projectId", "branch", "environmentSlug"}); err != nil {
		return err
	}
	return nil
}

func (v *V2DeployBuildSource) GetBuild() Build {
	if v == nil {
		return Build{}
	}
	return v.Build
}

func (v *V2DeployBuildSource) GetProjectID() string {
	if v == nil {
		return ""
	}
	return v.ProjectID
}

func (v *V2DeployBuildSource) GetKeyspaceID() *string {
	if v == nil {
		return nil
	}
	return v.KeyspaceID
}

func (v *V2DeployBuildSource) GetBranch() string {
	if v == nil {
		return ""
	}
	return v.Branch
}

func (v *V2DeployBuildSource) GetEnvironmentSlug() string {
	if v == nil {
		return ""
	}
	return v.EnvironmentSlug
}

func (v *V2DeployBuildSource) GetGitCommit() *components.V2DeployGitCommit {
	if v == nil {
		return nil
	}
	return v.GitCommit
}

type DeployCreateDeploymentRequestType string

const (
	DeployCreateDeploymentRequestTypeV2DeployBuildSource DeployCreateDeploymentRequestType = "V2DeployBuildSource"
	DeployCreateDeploymentRequestTypeV2DeployImageSource DeployCreateDeploymentRequestType = "V2DeployImageSource"
)

// DeployCreateDeploymentRequest - Deployment source - either build from source or use prebuilt image
type DeployCreateDeploymentRequest struct {
	V2DeployBuildSource *V2DeployBuildSource `queryParam:"inline" union:"member"`
	V2DeployImageSource *V2DeployImageSource `queryParam:"inline" union:"member"`

	Type DeployCreateDeploymentRequestType
}

func CreateDeployCreateDeploymentRequestV2DeployBuildSource(v2DeployBuildSource V2DeployBuildSource) DeployCreateDeploymentRequest {
	typ := DeployCreateDeploymentRequestTypeV2DeployBuildSource

	return DeployCreateDeploymentRequest{
		V2DeployBuildSource: &v2DeployBuildSource,
		Type:                typ,
	}
}

func CreateDeployCreateDeploymentRequestV2DeployImageSource(v2DeployImageSource V2DeployImageSource) DeployCreateDeploymentRequest {
	typ := DeployCreateDeploymentRequestTypeV2DeployImageSource

	return DeployCreateDeploymentRequest{
		V2DeployImageSource: &v2DeployImageSource,
		Type:                typ,
	}
}

func (u *DeployCreateDeploymentRequest) UnmarshalJSON(data []byte) error {

	var v2DeployBuildSource V2DeployBuildSource = V2DeployBuildSource{}
	if err := utils.UnmarshalJSON(data, &v2DeployBuildSource, "", true, nil); err == nil {
		u.V2DeployBuildSource = &v2DeployBuildSource
		u.Type = DeployCreateDeploymentRequestTypeV2DeployBuildSource
		return nil
	}

	var v2DeployImageSource V2DeployImageSource = V2DeployImageSource{}
	if err := utils.UnmarshalJSON(data, &v2DeployImageSource, "", true, nil); err == nil {
		u.V2DeployImageSource = &v2DeployImageSource
		u.Type = DeployCreateDeploymentRequestTypeV2DeployImageSource
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for DeployCreateDeploymentRequest", string(data))
}

func (u DeployCreateDeploymentRequest) MarshalJSON() ([]byte, error) {
	if u.V2DeployBuildSource != nil {
		return utils.MarshalJSON(u.V2DeployBuildSource, "", true)
	}

	if u.V2DeployImageSource != nil {
		return utils.MarshalJSON(u.V2DeployImageSource, "", true)
	}

	return nil, errors.New("could not marshal union type DeployCreateDeploymentRequest: all fields are null")
}

type DeployCreateDeploymentResponse struct {
	HTTPMeta components.HTTPMetadata `json:"-"`
	// Deployment created successfully
	V2DeployCreateDeploymentResponseBody *components.V2DeployCreateDeploymentResponseBody
}

func (d *DeployCreateDeploymentResponse) GetHTTPMeta() components.HTTPMetadata {
	if d == nil {
		return components.HTTPMetadata{}
	}
	return d.HTTPMeta
}

func (d *DeployCreateDeploymentResponse) GetV2DeployCreateDeploymentResponseBody() *components.V2DeployCreateDeploymentResponseBody {
	if d == nil {
		return nil
	}
	return d.V2DeployCreateDeploymentResponseBody
}
