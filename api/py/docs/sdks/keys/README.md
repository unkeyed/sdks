# Keys
(*keys*)

## Overview

API key management operations

### Available Operations

* [add_permissions](#add_permissions) - Add key permissions
* [add_roles](#add_roles) - Add key roles
* [create_key](#create_key) - Create API key
* [delete_key](#delete_key) - Delete API keys
* [get_key](#get_key) - Get API key
* [remove_permissions](#remove_permissions) - Remove key permissions
* [remove_roles](#remove_roles) - Remove key roles
* [reroll_key](#reroll_key) - Reroll Key
* [set_permissions](#set_permissions) - Set key permissions
* [set_roles](#set_roles) - Set key roles
* [update_credits](#update_credits) - Update key credits
* [update_key](#update_key) - Update key settings
* [verify_key](#verify_key) - Verify API key
* [whoami](#whoami) - Get API key by hash

## add_permissions

Add permissions to a key without affecting existing permissions.

Use this for privilege upgrades, enabling new features, or plan changes that grant additional capabilities. Permissions granted through roles remain unchanged.

**Important**: Changes take effect immediately with up to 30-second edge propagation.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Invalidates the key cache for immediate effect, and makes permissions available for verification within 30 seconds across all regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="addPermissions" method="post" path="/v2/keys.addPermissions" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.add_permissions(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", permissions=[])

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                     | Type                                                                                                                                                                                                                                                                                                                                                                                                          | Required                                                                                                                                                                                                                                                                                                                                                                                                      | Description                                                                                                                                                                                                                                                                                                                                                                                                   | Example                                                                                                                                                                                                                                                                                                                                                                                                       |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                      | *str*                                                                                                                                                                                                                                                                                                                                                                                                         | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                            | Specifies which key receives the additional permissions using the database identifier returned from `keys.createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>                                                                                                                                                                                             | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                    |
| `permissions`                                                                                                                                                                                                                                                                                                                                                                                                 | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                   | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                            | Grants additional permissions to the key through direct assignment or automatic creation.<br/>Duplicate permissions are ignored automatically, making this operation idempotent.<br/><br/>Adding permissions never removes existing permissions or role-based permissions.<br/><br/>Any permissions that do not exist will be auto created if the root key has permissions, otherwise this operation will fail with a 403 error.<br/> |                                                                                                                                                                                                                                                                                                                                                                                                               |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                     | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                              | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                            | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                               |

### Response

**[models.V2KeysAddPermissionsResponseBody](../../models/v2keysaddpermissionsresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## add_roles

Add roles to a key without affecting existing roles or permissions.

Use this for privilege upgrades, enabling new feature sets, or subscription changes that grant additional role-based capabilities. Direct permissions remain unchanged.

**Important**: Changes take effect immediately with up to 30-second edge propagation.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Invalidates the key cache for immediate effect, and makes role assignments available for verification within 30 seconds across all regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="addRoles" method="post" path="/v2/keys.addRoles" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.add_roles(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", roles=[
        "<value 1>",
    ])

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                            | Type                                                                                                                                                                                                                                                                                                                                                                                 | Required                                                                                                                                                                                                                                                                                                                                                                             | Description                                                                                                                                                                                                                                                                                                                                                                          | Example                                                                                                                                                                                                                                                                                                                                                                              |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                             | *str*                                                                                                                                                                                                                                                                                                                                                                                | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                   | Specifies which key receives the additional roles using the database identifier returned from `createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>Added roles supplement existing roles and permissions without replacing them.<br/>Role assignments take effect immediately but may take up to 30 seconds to propagate across all regions.<br/> | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                           |
| `roles`                                                                                                                                                                                                                                                                                                                                                                              | List[*str*]                                                                                                                                                                                                                                                                                                                                                                          | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                   | Assigns additional roles to the key through direct assignment to existing workspace roles.<br/>Operations are idempotent - adding existing roles has no effect and causes no errors.<br/><br/>All roles must already exist in the workspace - roles cannot be created automatically.<br/>Invalid roles cause the entire operation to fail atomically, ensuring consistent state.<br/> |                                                                                                                                                                                                                                                                                                                                                                                      |
| `retries`                                                                                                                                                                                                                                                                                                                                                                            | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                   | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                      |

### Response

**[models.V2KeysAddRolesResponseBody](../../models/v2keysaddrolesresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## create_key

Create a new API key for user authentication and authorization.

Use this endpoint when users sign up, upgrade subscription tiers, or need additional keys. Keys are cryptographically secure and unique to the specified API namespace.

**Important**: The key is returned only once. Store it immediately and provide it to your user, as it cannot be retrieved later.

**Common use cases:**
- Generate keys for new user registrations
- Create additional keys for different applications
- Issue keys with specific permissions or limits

**Required Permissions**

Your root key needs one of:
- `api.*.create_key` (create keys in any API)
- `api.<api_id>.create_key` (create keys in specific API)


### Example Usage

<!-- UsageSnippet language="python" operationID="createKey" method="post" path="/v2/keys.createKey" -->
```python
from unkey.py import Unkey, models


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.create_key(api_id="api_1234abcd", prefix="prod", name="Payment Service Production Key", byte_length=24, external_id="user_1234abcd", meta={
        "plan": "enterprise",
        "featureFlags": {
            "betaAccess": True,
            "concurrentConnections": 10,
        },
        "customerName": "Acme Corp",
        "billing": {
            "tier": "premium",
            "renewal": "2024-12-31",
        },
    }, roles=[
        "api_admin",
        "billing_reader",
    ], permissions=[
        "documents.read",
        "documents.write",
        "settings.view",
    ], expires=1704067200000, ratelimits=[
        {
            "name": "requests",
            "limit": 100,
            "duration": 60000,
            "auto_apply": True,
        },
        {
            "name": "heavy_operations",
            "limit": 10,
            "duration": 3600000,
        },
    ], enabled=True, recoverable=False, key_credits={
        "remaining": 1000,
        "refill": {
            "interval": models.Interval.DAILY,
            "amount": 1000,
            "refill_day": 15,
        },
    })

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `api_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | The API namespace this key belongs to.<br/>Keys from different APIs cannot access each other.<br/>                                                                                                                                                                                                                                                                                                                                                                                              | api_1234abcd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `prefix`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | *Optional[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Adds a visual identifier to the beginning of the generated key for easier recognition in logs and dashboards.<br/>The prefix becomes part of the actual key string (e.g., `prod_xxxxxxxxx`).<br/>Avoid using sensitive information in prefixes as they may appear in logs and error messages.<br/>                                                                                                                                                                                              | prod                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `name`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | *Optional[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Sets a human-readable identifier for internal organization and dashboard display.<br/>Never exposed to end users, only visible in management interfaces and API responses.<br/>Avoid generic names like "API Key" when managing multiple keys for the same user or service.<br/>                                                                                                                                                                                                                | Payment Service Production Key                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `byte_length`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | *Optional[int]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Controls the cryptographic strength of the generated key in bytes.<br/>Higher values increase security but result in longer keys that may be more annoying to handle.<br/>The default 16 bytes provides 2^128 possible combinations, sufficient for most applications.<br/>Consider 32 bytes for highly sensitive APIs, but avoid values above 64 bytes unless specifically required.<br/>                                                                                                      | 24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `external_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | *Optional[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Links this key to a user or entity in your system using your own identifier.<br/>Returned during verification to identify the key owner without additional database lookups.<br/>Essential for user-specific analytics, billing, and multi-tenant key management.<br/>Use your primary user ID, organization ID, or tenant ID for best results.<br/>Accepts letters, numbers, underscores, dots, and hyphens for flexible identifier formats.<br/>                                              | user_1234abcd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `meta`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Dict[str, *Any*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Stores arbitrary JSON metadata returned during key verification for contextual information.<br/>Eliminates additional database lookups during verification, improving performance for stateless services.<br/>Avoid storing sensitive data here as it's returned in verification responses.<br/>Large metadata objects increase verification latency and should stay under 10KB total size.<br/>                                                                                                | {<br/>"plan": "enterprise",<br/>"featureFlags": {<br/>"betaAccess": true,<br/>"concurrentConnections": 10<br/>},<br/>"customerName": "Acme Corp",<br/>"billing": {<br/>"tier": "premium",<br/>"renewal": "2024-12-31"<br/>}<br/>}                                                                                                                                                                                                                                                               |
| `roles`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Assigns existing roles to this key for permission management through role-based access control.<br/>Roles must already exist in your workspace before assignment.<br/>During verification, all permissions from assigned roles are checked against requested permissions.<br/>Roles provide a convenient way to group permissions and apply consistent access patterns across multiple keys.<br/>                                                                                               | [<br/>"api_admin",<br/>"billing_reader"<br/>]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `permissions`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Grants specific permissions directly to this key without requiring role membership.<br/>Wildcard permissions like `documents.*` grant access to all sub-permissions including `documents.read` and `documents.write`.<br/>Direct permissions supplement any permissions inherited from assigned roles.<br/>                                                                                                                                                                                     | [<br/>"documents.read",<br/>"documents.write",<br/>"settings.view"<br/>]                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `expires`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *Optional[int]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Sets when this key automatically expires as a Unix timestamp in milliseconds.<br/>Verification fails with code=EXPIRED immediately after this time passes.<br/>Omitting this field creates a permanent key that never expires.<br/><br/>Avoid setting timestamps in the past as they immediately invalidate the key.<br/>Keys expire based on server time, not client time, which prevents timezone-related issues.<br/>Essential for trial periods, temporary access, and security compliance requiring key rotation.<br/> | 1704067200000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `ratelimits`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | List[[models.RatelimitRequest](../../models/ratelimitrequest.md)]                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Defines time-based rate limits that protect against abuse by controlling request frequency.<br/>Unlike credits which track total usage, rate limits reset automatically after each window expires.<br/>Multiple rate limits can control different operation types with separate thresholds and windows.<br/>Essential for preventing API abuse while maintaining good performance for legitimate usage.<br/>                                                                                    | [<br/>{<br/>"name": "requests",<br/>"limit": 100,<br/>"duration": 60000,<br/>"autoApply": true<br/>},<br/>{<br/>"name": "heavy_operations",<br/>"limit": 10,<br/>"duration": 3600000,<br/>"autoApply": false<br/>}<br/>]                                                                                                                                                                                                                                                                        |
| `enabled`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Controls whether the key is active immediately upon creation.<br/>When set to `false`, the key exists but all verification attempts fail with `code=DISABLED`.<br/>Useful for pre-creating keys that will be activated later or for keys requiring manual approval.<br/>Most keys should be created with `enabled=true` for immediate use.<br/>                                                                                                                                                 | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `recoverable`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Controls whether the plaintext key is stored in an encrypted vault for later retrieval.<br/>When true, allows recovering the actual key value using keys.getKey with decrypt=true.<br/>When false, the key value cannot be retrieved after creation for maximum security.<br/>Only enable for development keys or when key recovery is absolutely necessary.<br/>                                                                                                                               | false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `key_credits`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [Optional[models.KeyCreditsData]](../../models/keycreditsdata.md)                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Credit configuration and remaining balance for this key.                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

### Response

**[models.V2KeysCreateKeyResponseBody](../../models/v2keyscreatekeyresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## delete_key

Delete API keys permanently from user accounts or for cleanup purposes.

Use this for user-requested key deletion, account deletion workflows, or cleaning up unused keys. Keys are immediately invalidated. Two modes: soft delete (default, preserves audit records) and permanent delete.

**Important**: For temporary access control, use `updateKey` with `enabled: false` instead of deletion.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.delete_key` (to delete keys in any API)
- `api.<api_id>.delete_key` (to delete keys in a specific API)


### Example Usage

<!-- UsageSnippet language="python" operationID="deleteKey" method="post" path="/v2/keys.deleteKey" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.delete_key(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", permanent=False)

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Specifies which key to delete using the database identifier returned from `createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>Deletion immediately invalidates the key, causing all future verification attempts to fail with `code=NOT_FOUND`.<br/>Key deletion triggers cache invalidation across all regions but may take up to 30 seconds to fully propagate.<br/>                                                                                                                                                                                                                                     | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `permanent`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Controls deletion behavior between recoverable soft-deletion and irreversible permanent erasure.<br/>Soft deletion (default) preserves key data for potential recovery through direct database operations.<br/>Permanent deletion completely removes all traces including hash values and metadata with no recovery option.<br/><br/>Use permanent deletion only for regulatory compliance (GDPR), resolving hash collisions, or when reusing identical key strings.<br/>Permanent deletion cannot be undone and may affect analytics data that references the deleted key.<br/>Most applications should use soft deletion to maintain audit trails and prevent accidental data loss.<br/> | false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

### Response

**[models.V2KeysDeleteKeyResponseBody](../../models/v2keysdeletekeyresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## get_key

Retrieve detailed key information for dashboard interfaces and administrative purposes.

Use this to build key management dashboards showing users their key details, status, permissions, and usage data. You can identify keys by `keyId` or the actual key string.

**Important**: Set `decrypt: true` only in secure contexts to retrieve plaintext key values from recoverable keys.

**Required Permissions**

Your root key must have one of the following permissions for basic key information:
- `api.*.read_key` (to read keys from any API)
- `api.<api_id>.read_key` (to read keys from a specific API)

Additional permission required for decrypt functionality:
- `api.*.decrypt_key` or `api.<api_id>.decrypt_key`


### Example Usage

<!-- UsageSnippet language="python" operationID="getKey" method="post" path="/v2/keys.getKey" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.get_key(key_id="key_1234abcd", decrypt=False)

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Specifies which key to retrieve using the database identifier returned from `keys.createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>Key data includes metadata, permissions, usage statistics, and configuration but never the plaintext key value unless `decrypt=true`.<br/>Find this ID in creation responses, key listings, dashboard, or verification responses.<br/>                                                                                                                                                       | key_1234abcd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `decrypt`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Controls whether to include the plaintext key value in the response for recovery purposes.<br/>Only works for keys created with `recoverable=true` and requires the `decrypt_key` permission.<br/>Returned keys must be handled securely, never logged, cached, or stored insecurely.<br/><br/>Use only for legitimate recovery scenarios like user password resets or emergency access.<br/>Most applications should keep this false to maintain security best practices and avoid accidental key exposure.<br/>Decryption requests are audited and may trigger security alerts in enterprise environments.<br/> |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

### Response

**[models.V2KeysGetKeyResponseBody](../../models/v2keysgetkeyresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## remove_permissions

Remove permissions from a key without affecting existing roles or other permissions.

Use this for privilege downgrades, removing temporary access, or plan changes that revoke specific capabilities. Permissions granted through roles remain unchanged.

**Important**: Changes take effect immediately with up to 30-second edge propagation.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Invalidates the key cache for immediate effect, and makes permission changes available for verification within 30 seconds across all regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="removePermissions" method="post" path="/v2/keys.removePermissions" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.remove_permissions(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", permissions=[])

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                         | Type                                                                                                                                                                                                                                              | Required                                                                                                                                                                                                                                          | Description                                                                                                                                                                                                                                       | Example                                                                                                                                                                                                                                           |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                          | *str*                                                                                                                                                                                                                                             | :heavy_check_mark:                                                                                                                                                                                                                                | Specifies which key to remove permissions from using the database identifier returned from `keys.createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>                                          | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                        |
| `permissions`                                                                                                                                                                                                                                     | List[*str*]                                                                                                                                                                                                                                       | :heavy_check_mark:                                                                                                                                                                                                                                | Removes direct permissions from the key without affecting role-based permissions.<br/><br/>You can either use a permission slug, or the permission ID.<br/><br/>After removal, verification checks for these permissions will fail unless granted through roles.<br/> |                                                                                                                                                                                                                                                   |
| `retries`                                                                                                                                                                                                                                         | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                                                                | Configuration to override the default retry behavior of the client.                                                                                                                                                                               |                                                                                                                                                                                                                                                   |

### Response

**[models.V2KeysRemovePermissionsResponseBody](../../models/v2keysremovepermissionsresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## remove_roles

Remove roles from a key without affecting direct permissions or other roles.

Use this for privilege downgrades, removing temporary access, or subscription changes that revoke specific role-based capabilities. Direct permissions remain unchanged.

**Important**: Changes take effect immediately with up to 30-second edge propagation.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Invalidates the key cache for immediate effect, and makes role changes available for verification within 30 seconds across all regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="removeRoles" method="post" path="/v2/keys.removeRoles" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.remove_roles(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", roles=[
        "<value 1>",
        "<value 2>",
    ])

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                        | Type                                                                                                                                                                                                                                                                                                                                                                                             | Required                                                                                                                                                                                                                                                                                                                                                                                         | Description                                                                                                                                                                                                                                                                                                                                                                                      | Example                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                         | *str*                                                                                                                                                                                                                                                                                                                                                                                            | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                               | Specifies which key loses the roles using the database identifier returned from createKey.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>Removing roles only affects direct assignments, not permissions inherited from other sources.<br/>Role changes take effect immediately but may take up to 30 seconds to propagate across all regions.<br/> | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                       |
| `roles`                                                                                                                                                                                                                                                                                                                                                                                          | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                      | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                               | Removes direct role assignments from the key without affecting other role sources or permissions.<br/>Operations are idempotent - removing non-assigned roles has no effect and causes no errors.<br/><br/>After removal, the key loses access to permissions that were only granted through these roles.<br/>Invalid role references cause the entire operation to fail atomically, ensuring consistent state.<br/> |                                                                                                                                                                                                                                                                                                                                                                                                  |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                        | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                               | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                  |

### Response

**[models.V2KeysRemoveRolesResponseBody](../../models/v2keysremoverolesresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## reroll_key

Generate a new API key while preserving the configuration from an existing key.

This operation creates a fresh key with a new token while maintaining all settings from the original key:
- Permissions and roles
- Custom metadata
- Rate limit configurations
- Identity associations
- Remaining credits
- Recovery settings

**Key Generation:**
- The system attempts to extract the prefix from the original key
- If prefix extraction fails, the default API prefix is used
- Key length follows the API's default byte configuration (or 16 bytes if not specified)

**Original Key Handling:**
- The original key will be revoked after the duration specified in `expiration`
- Set `expiration` to 0 to revoke immediately
- This allows for graceful key rotation with an overlap period

Common use cases include:
- Rotating keys for security compliance
- Issuing replacement keys for compromised credentials
- Creating backup keys with identical permissions

**Important:** Analytics and usage metrics are tracked at both the key level AND identity level. If the original key has an identity, the new key will inherit it, allowing you to track usage across both individual keys and the overall identity.

**Required Permissions**

 Your root key must have:
 - `api.*.create_key` or `api.<api_id>.create_key`
 - `api.*.encrypt_key` or `api.<api_id>.encrypt_key` (only when the original key is recoverable)


### Example Usage

<!-- UsageSnippet language="python" operationID="rerollKey" method="post" path="/v2/keys.rerollKey" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.reroll_key(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", expiration=86400000)

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The database identifier of the key to reroll.<br/><br/>This is the unique ID returned when creating or listing keys, NOT the actual API key token.<br/>You can find this ID in:<br/>- The response from `keys.createKey`<br/>- Key verification responses<br/>- The Unkey dashboard<br/>- API key listing endpoints<br/>                                                                                                                                                                                                                         | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `expiration`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | *int*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Duration in milliseconds until the ORIGINAL key is revoked, starting from now.<br/><br/>This parameter controls the overlap period for key rotation:<br/>- Set to `0` to revoke the original key immediately<br/>- Positive values keep the original key active for the specified duration<br/>- Allows graceful migration by giving users time to update their credentials<br/><br/>Common overlap periods:<br/>- Immediate revocation: 0<br/>- 1 hour grace period: 3600000<br/>- 24 hours grace period: 86400000<br/>- 7 days grace period: 604800000<br/>- 30 days grace period: 2592000000<br/> | 86400000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

### Response

**[models.V2KeysRerollKeyResponseBody](../../models/v2keysrerollkeyresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## set_permissions

Replace all permissions on a key with the specified set in a single atomic operation.

Use this to synchronize with external systems, reset permissions to a known state, or apply standardized permission templates. Permissions granted through roles remain unchanged.

**Important**: Changes take effect immediately with up to 30-second edge propagation.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Invalidates the key cache for immediate effect, and makes permission changes available for verification within 30 seconds across all regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="setPermissions" method="post" path="/v2/keys.setPermissions" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.set_permissions(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", permissions=[
        "<value 1>",
    ])

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Specifies which key receives the additional permissions using the database identifier returned from `keys.createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>                                                                                                                                                                                                                                                                                                                                              | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `permissions`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | The permissions to set for this key.<br/><br/>This is a complete replacement operation - it overwrites all existing direct permissions with this new set.<br/><br/>Key behaviors:<br/>- Providing an empty array removes all direct permissions from the key<br/>- This only affects direct permissions - permissions granted through roles are not affected<br/>- All existing direct permissions not included in this list will be removed<br/><br/>Any permissions that do not exist will be auto created if the root key has permissions, otherwise this operation will fail with a 403 error. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

### Response

**[models.V2KeysSetPermissionsResponseBody](../../models/v2keyssetpermissionsresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## set_roles

Replace all roles on a key with the specified set in a single atomic operation.

Use this to synchronize with external systems, reset roles to a known state, or apply standardized role templates. Direct permissions are never affected.

**Important**: Changes take effect immediately with up to 30-second edge propagation.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Invalidates the key cache for immediate effect, and makes role changes available for verification within 30 seconds across all regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="setRoles" method="post" path="/v2/keys.setRoles" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.set_roles(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", roles=[
        "<value 1>",
        "<value 2>",
        "<value 3>",
    ])

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                       | Type                                                                                                                                                                                                                                                                                                                                                                                                                                            | Required                                                                                                                                                                                                                                                                                                                                                                                                                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                     | Example                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                        | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                           | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                              | Specifies which key gets the complete role replacement using the database identifier returned from createKey.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>This is a wholesale replacement operation that removes all existing roles not included in the request.<br/>Role changes take effect immediately but may take up to 30 seconds to propagate across all regions.<br/>                    | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `roles`                                                                                                                                                                                                                                                                                                                                                                                                                                         | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                              | Replaces all existing role assignments with this complete list of roles.<br/>This is a wholesale replacement operation, not an incremental update like add/remove operations.<br/><br/>Providing an empty array removes all direct role assignments from the key.<br/>All roles must already exist in the workspace - roles cannot be created automatically.<br/>Invalid role references cause the entire operation to fail atomically, ensuring consistent state.<br/> |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                       | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                              | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

### Response

**[models.V2KeysSetRolesResponseBody](../../models/v2keyssetrolesresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## update_credits

Update credit quotas in response to plan changes, billing cycles, or usage purchases.

Use this for user upgrades/downgrades, monthly quota resets, credit purchases, or promotional bonuses. Supports three operations: set, increment, or decrement credits. Set to null for unlimited usage.

**Important**: Setting unlimited credits automatically clears existing refill configurations.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

Credit updates remove the key from cache immediately. Setting credits to unlimited automatically clears any existing refill settings. Changes take effect instantly but may take up to 30 seconds to propagate to all edge regions.


### Example Usage

<!-- UsageSnippet language="python" operationID="updateCredits" method="post" path="/v2/keys.updateCredits" -->
```python
from unkey.py import Unkey, models


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.update_credits(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", operation=models.Operation.SET, value=1000)

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The ID of the key to update (begins with `key_`). This is the database reference ID for the key, not the actual API key string that users authenticate with. This ID uniquely identifies which key's credits will be updated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `operation`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [models.Operation](../../models/operation.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Defines how to modify the key's remaining credits. Use 'set' to replace current credits with a specific value or unlimited usage, 'increment' to add credits for plan upgrades or credit purchases, and 'decrement' to reduce credits for refunds or policy violations.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | set                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `value`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | *OptionalNullable[int]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The credit value to use with the specified operation. The meaning depends on the operation: for 'set', this becomes the new remaining credits value; for 'increment', this amount is added to current credits; for 'decrement', this amount is subtracted from current credits.<br/><br/>Set to null when using 'set' operation to make the key unlimited (removes usage restrictions entirely). When decrementing, if the result would be negative, remaining credits are automatically set to zero. Credits are consumed during successful key verification, and when credits reach zero, verification fails with `code=INSUFFICIENT_CREDITS`.<br/><br/>Required when using 'increment' or 'decrement' operations. Optional for 'set' operation (null creates unlimited usage).<br/> | 1000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

### Response

**[models.V2KeysUpdateCreditsResponseBody](../../models/v2keysupdatecreditsresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## update_key

Update key properties in response to plan changes, subscription updates, or account status changes.

Use this for user upgrades/downgrades, role modifications, or administrative changes. Supports partial updates - only specify fields you want to change. Set fields to null to clear them.

**Important**: Permissions and roles are replaced entirely. Use dedicated add/remove endpoints for incremental changes.

**Required Permissions**

Your root key must have one of the following permissions:
- `api.*.update_key` (to update keys in any API)
- `api.<api_id>.update_key` (to update keys in a specific API)

**Side Effects**

If you specify an `externalId` that doesn't exist, a new identity will be automatically created and linked to the key. Permission updates will auto-create any permissions that don't exist in your workspace. Changes take effect immediately but may take up to 30 seconds to propagate to all edge regions due to cache invalidation.


### Example Usage

<!-- UsageSnippet language="python" operationID="updateKey" method="post" path="/v2/keys.updateKey" -->
```python
from unkey.py import Unkey, models


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.update_key(key_id="key_2cGKbMxRyIzhCxo1Idjz8q", name="Payment Service Production Key", external_id="user_912a841d", meta={
        "plan": "enterprise",
        "limits": {
            "storage": "500GB",
            "compute": "1000 minutes/month",
        },
        "features": [
            "analytics",
            "exports",
            "webhooks",
        ],
        "hasAcceptedTerms": True,
        "billing": {
            "cycle": "monthly",
            "next_billing": "2024-01-15",
        },
        "preferences": {
            "timezone": "UTC",
            "notifications": True,
        },
        "lastBillingDate": "2023-10-15",
    }, expires=1704067200000, ratelimits=[
        {
            "name": "api",
            "limit": 453542,
            "duration": 350222,
        },
    ], enabled=True, roles=[
        "api_admin",
        "billing_reader",
    ], permissions=[
        "documents.read",
        "documents.write",
        "settings.view",
    ], key_credits={
        "remaining": 1000,
        "refill": {
            "interval": models.Interval.DAILY,
            "amount": 1000,
            "refill_day": 15,
        },
    })

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Specifies which key to update using the database identifier returned from `createKey`.<br/>Do not confuse this with the actual API key string that users include in requests.<br/>                                                                                                                                                                                                                                                                                                                              | key_2cGKbMxRyIzhCxo1Idjz8q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `name`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | *OptionalNullable[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Sets a human-readable name for internal organization and identification.<br/>Omitting this field leaves the current name unchanged, while setting null removes it entirely.<br/>Avoid generic names like "API Key" when managing multiple keys per user or service.<br/>                                                                                                                                                                                                                                        | Payment Service Production Key                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `external_id`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | *OptionalNullable[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Links this key to a user or entity in your system for ownership tracking during verification.<br/>Omitting this field preserves the current association, while setting null disconnects the key from any identity.<br/>Essential for user-specific analytics, billing, and key management across multiple users.<br/>Supports letters, numbers, underscores, dots, and hyphens for flexible identifier formats.<br/>                                                                                            | user_912a841d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `meta`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Dict[str, *Any*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Stores arbitrary JSON metadata returned during key verification.<br/>Omitting this field preserves existing metadata, while setting null removes all metadata entirely.<br/>Avoid storing sensitive data here as it's returned in verification responses.<br/>Large metadata objects increase verification latency and should stay under 10KB total size.<br/>                                                                                                                                                  | {<br/>"plan": "enterprise",<br/>"limits": {<br/>"storage": "500GB",<br/>"compute": "1000 minutes/month"<br/>},<br/>"features": [<br/>"analytics",<br/>"exports",<br/>"webhooks"<br/>],<br/>"hasAcceptedTerms": true,<br/>"billing": {<br/>"cycle": "monthly",<br/>"next_billing": "2024-01-15"<br/>},<br/>"preferences": {<br/>"timezone": "UTC",<br/>"notifications": true<br/>},<br/>"lastBillingDate": "2023-10-15"<br/>}                                                                                    |
| `expires`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *OptionalNullable[int]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Sets when this key automatically expires as a Unix timestamp in milliseconds.<br/>Verification fails with code=EXPIRED immediately after this time passes.<br/>Omitting this field preserves the current expiration, while setting null makes the key permanent.<br/><br/>Avoid setting timestamps in the past as they immediately invalidate the key.<br/>Keys expire based on server time, not client time, which prevents timezone-related issues.<br/>Active sessions continue until their next verification attempt after expiry.<br/> | 1704067200000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `ratelimits`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | List[[models.RatelimitRequest](../../models/ratelimitrequest.md)]                                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Defines time-based rate limits that protect against abuse by controlling request frequency.<br/>Omitting this field preserves existing rate limits, while setting null removes all rate limits.<br/>Unlike credits which track total usage, rate limits reset automatically after each window expires.<br/>Multiple rate limits can control different operation types with separate thresholds and windows.<br/>                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `enabled`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Controls whether the key is currently active for verification requests.<br/>When set to `false`, all verification attempts fail with `code=DISABLED` regardless of other settings.<br/>Omitting this field preserves the current enabled status.<br/>Useful for temporarily suspending access during billing issues, security incidents, or maintenance windows without losing key configuration.<br/>                                                                                                          | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `roles`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [<br/>"api_admin",<br/>"billing_reader"<br/>]                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `permissions`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [<br/>"documents.read",<br/>"documents.write",<br/>"settings.view"<br/>]                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `key_credits`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [Optional[models.KeyCreditsData]](../../models/keycreditsdata.md)                                                                                                                                                                                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Credit configuration and remaining balance for this key.                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

### Response

**[models.V2KeysUpdateKeyResponseBody](../../models/v2keysupdatekeyresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## verify_key

Verify an API key's validity and permissions for request authentication.

Use this endpoint on every incoming request to your protected resources. It checks key validity, permissions, rate limits, and usage quotas in a single call.

**Important**: Always returns HTTP 200. Check the `valid` field in response data to determine if the key is authorized.

**Common use cases:**
- Authenticate API requests before processing
- Enforce permission-based access control
- Track usage and apply rate limits

**Required Permissions**

Your root key needs one of:
- `api.*.verify_key` (verify keys in any API)
- `api.<api_id>.verify_key` (verify keys in specific API)

If you are getting a NOT_FOUND error, ensure your root key has the required verify key permissions.


### Example Usage

<!-- UsageSnippet language="python" operationID="verifyKey" method="post" path="/v2/keys.verifyKey" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.verify_key(key="sk_1234abcdef", tags=[
        "endpoint=/users/profile",
        "method=GET",
        "region=us-east-1",
        "clientVersion=2.3.0",
        "feature=premium",
    ], permissions="documents.read AND users.view", ratelimits=[
        {
            "name": "tokens",
            "cost": 2,
            "limit": 50,
            "duration": 600000,
        },
    ], key_credits={
        "cost": 5,
    })

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Required                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key`                                                                                                                                                                                                                                                                                                                                                                                                                                                             | *str*                                                                                                                                                                                                                                                                                                                                                                                                                                                             | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                                                | The API key to verify, exactly as provided by your user.<br/>Include any prefix - even small changes will cause verification to fail.<br/>                                                                                                                                                                                                                                                                                                                        | sk_1234abcdef                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `tags`                                                                                                                                                                                                                                                                                                                                                                                                                                                            | List[*str*]                                                                                                                                                                                                                                                                                                                                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                | Attaches metadata tags for analytics and monitoring without affecting verification outcomes.<br/>Enables segmentation of API usage in dashboards by endpoint, client version, region, or custom dimensions.<br/>Use 'key=value' format for compatibility with most analytics tools and clear categorization.<br/>Avoid including sensitive data in tags as they may appear in logs and analytics reports.<br/>                                                    | [<br/>"endpoint=/users/profile",<br/>"method=GET",<br/>"region=us-east-1",<br/>"clientVersion=2.3.0",<br/>"feature=premium"<br/>]                                                                                                                                                                                                                                                                                                                                 |
| `permissions`                                                                                                                                                                                                                                                                                                                                                                                                                                                     | *Optional[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                                   | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                | Checks if the key has the specified permission(s) using a query syntax.<br/>Supports single permissions, logical operators (AND, OR), and parentheses for grouping.<br/>Examples:<br/>- Single permission: "documents.read"<br/>- Multiple permissions: "documents.read AND documents.write"<br/>- Complex queries: "(documents.read OR documents.write) AND users.view"<br/>Verification fails if the key lacks the required permissions through direct assignment or role inheritance.<br/> | documents.read AND users.view                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `ratelimits`                                                                                                                                                                                                                                                                                                                                                                                                                                                      | List[[models.KeysVerifyKeyRatelimit](../../models/keysverifykeyratelimit.md)]                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                | Enforces time-based rate limiting during verification to prevent abuse and ensure fair usage.<br/>Omitting this field skips rate limit checks entirely, relying only on configured key rate limits.<br/>Multiple rate limits can be checked simultaneously, each with different costs and temporary overrides.<br/>Rate limit checks are optimized for performance but may allow brief bursts during high concurrency.<br/>                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `key_credits`                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [Optional[models.KeysVerifyKeyCredits]](../../models/keysverifykeycredits.md)                                                                                                                                                                                                                                                                                                                                                                                     | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                | Controls credit consumption for usage-based billing and quota enforcement.<br/>Omitting this field uses the default cost of 1 credit per verification.<br/>Credits provide globally consistent usage tracking, essential for paid APIs with strict quotas.<br/>                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                                         | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                                                | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

### Response

**[models.V2KeysVerifyKeyResponseBody](../../models/v2keysverifykeyresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |

## whoami

Find out what key this is.

**Required Permissions**

Your root key must have one of the following permissions for basic key information:
- `api.*.read_key` (to read keys from any API)
- `api.<api_id>.read_key` (to read keys from a specific API)

If your rootkey lacks permissions but the key exists, we may return a 404 status here to prevent leaking the existance of a key to unauthorized clients. If you believe that a key should exist, but receive a 404, please double check your root key has the correct permissions.


### Example Usage

<!-- UsageSnippet language="python" operationID="whoami" method="post" path="/v2/keys.whoami" -->
```python
from unkey.py import Unkey


with Unkey(
    root_key="<YOUR_BEARER_TOKEN_HERE>",
) as unkey:

    res = unkey.keys.whoami(key="sk_1234abcdef5678")

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                               | Type                                                                                                                                                                                                                                                                    | Required                                                                                                                                                                                                                                                                | Description                                                                                                                                                                                                                                                             | Example                                                                                                                                                                                                                                                                 |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `key`                                                                                                                                                                                                                                                                   | *str*                                                                                                                                                                                                                                                                   | :heavy_check_mark:                                                                                                                                                                                                                                                      | The complete API key string provided by you, including any prefix.<br/>Never log, cache, or store API keys in your system as they provide full access to user resources.<br/>Include the full key exactly as provided - even minor modifications will cause a not found error.<br/> | sk_1234abcdef5678                                                                                                                                                                                                                                                       |
| `retries`                                                                                                                                                                                                                                                               | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                        | :heavy_minus_sign:                                                                                                                                                                                                                                                      | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                         |

### Response

**[models.V2KeysWhoamiResponseBody](../../models/v2keyswhoamiresponsebody.md)**

### Errors

| Error Type                         | Status Code                        | Content Type                       |
| ---------------------------------- | ---------------------------------- | ---------------------------------- |
| errors.BadRequestErrorResponse     | 400                                | application/json                   |
| errors.UnauthorizedErrorResponse   | 401                                | application/json                   |
| errors.ForbiddenErrorResponse      | 403                                | application/json                   |
| errors.NotFoundErrorResponse       | 404                                | application/json                   |
| errors.InternalServerErrorResponse | 500                                | application/json                   |
| errors.APIError                    | 4XX, 5XX                           | \*/\*                              |